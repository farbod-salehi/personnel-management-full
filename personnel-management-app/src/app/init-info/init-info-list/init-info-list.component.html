<mat-card class="mat-card" appearance="outlined" style="width: 800px">
  <mat-card-header class="mat-card-header">
    <mat-card-title class="mat-card-title"> فهرست اطلاعات پایه</mat-card-title>
  </mat-card-header>
  <mat-card-content class="mat-card-content container-vertical">
    <app-button-loader
      text="جدید"
      iconName="add"
      [routerLink]="['/', route_NamePath.initInfoItemForm, selectedTypeId]"
    ></app-button-loader>
    <app-error-message-box
      [text]="errorMessage()"
      style="width: 80%; margin: 20px 0px"
    ></app-error-message-box>
    <mat-form-field
      class="mat-form-field"
      appearance="outline"
      style="margin-top: 15px; width: 50%"
      floatLabel="always"
    >
      <mat-label> نوع اطلاعات پایه</mat-label>
      <mat-select
        [(ngModel)]="selectedTypeId"
        name="type"
        (selectionChange)="onTypeChange()"
        [disabled]="isLoading()"
      >
        @for (type of typesList; track type.id) {
        <mat-option [value]="type.id">{{ type.title }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    @if(isLoading()) {
    <mat-spinner style="margin: 30px auto" diameter="50"></mat-spinner>
    } @else if (list() && list().length > 0) {

    <table mat-table [dataSource]="list()" class="mat-elevation-z8">
      <!--- Note that these columns can be defined in any order.
              The actual rendered columns are set as a property on the row definition" -->

      <ng-container matColumnDef="No">
        <th mat-header-cell *matHeaderCellDef class="mat-table-header">ردیف</th>
        <td mat-cell *matCellDef="let element" class="mat-table-row">
          {{ element.rowNumber | faNum }}
        </td>
      </ng-container>

      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef class="mat-table-header">
          عنوان
        </th>
        <td mat-cell *matCellDef="let element" class="mat-table-row">
          {{ element.title }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element" class="mat-table-row">
          <div
            class="container-horizontal"
            style="justify-content: flex-end; gap: 20px"
          >
            <app-button-loader
              text="ویرایش"
              iconName="edit"
              color="yellow"
              [routerLink]="[
                '/',
                route_NamePath.initInfoItemForm,
                selectedTypeId,
                element.id
              ]"
            >
            </app-button-loader>
            <app-button-loader text="حذف" iconName="delete" color="red">
            </app-button-loader>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    } @else {
    <app-error-message-box
      style="width: 100%"
      text="داده‌ای برای نمایش وجود ندارد."
      color="blue"
    ></app-error-message-box>
    }
  </mat-card-content>
</mat-card>
